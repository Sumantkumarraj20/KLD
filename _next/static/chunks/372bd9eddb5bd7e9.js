(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1085,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={AppRouterContext:function(){return n},GlobalLayoutRouterContext:function(){return o},LayoutRouterContext:function(){return i},MissingSlotContext:function(){return u},TemplateContext:function(){return d}};for(var s in a)Object.defineProperty(r,s,{enumerable:!0,get:a[s]});let l=e.r(41705)._(e.r(91788)),n=l.default.createContext(null),i=l.default.createContext(null),o=l.default.createContext(null),d=l.default.createContext(null),u=l.default.createContext(new Set)},31430,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return s}});class a extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class s extends URLSearchParams{append(){throw new a}delete(){throw new a}set(){throw new a}sort(){throw new a}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},70008,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={NavigationPromisesContext:function(){return u},PathParamsContext:function(){return d},PathnameContext:function(){return o},ReadonlyURLSearchParams:function(){return n.ReadonlyURLSearchParams},SearchParamsContext:function(){return i},createDevToolsInstrumentedPromise:function(){return c}};for(var s in a)Object.defineProperty(r,s,{enumerable:!0,get:a[s]});let l=e.r(91788),n=e.r(31430),i=(0,l.createContext)(null),o=(0,l.createContext)(null),d=(0,l.createContext)(null),u=(0,l.createContext)(null);function c(e,t){let r=Promise.resolve(t);return r.status="fulfilled",r.value=t,r.displayName=`${e} (SSR)`,r}},14760,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={BailoutToCSRError:function(){return n},isBailoutToCSRError:function(){return i}};for(var s in a)Object.defineProperty(r,s,{enumerable:!0,get:a[s]});let l="BAILOUT_TO_CLIENT_SIDE_RENDERING";class n extends Error{constructor(e){super(`Bail out to client-side rendering: ${e}`),this.reason=e,this.digest=l}}function i(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===l}},91622,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={HTTPAccessErrorStatus:function(){return l},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return i},getAccessFallbackErrorTypeByStatus:function(){return u},getAccessFallbackHTTPStatus:function(){return d},isHTTPAccessFallbackError:function(){return o}};for(var s in a)Object.defineProperty(r,s,{enumerable:!0,get:a[s]});let l={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},n=new Set(Object.values(l)),i="NEXT_HTTP_ERROR_FALLBACK";function o(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r]=e.digest.split(";");return t===i&&n.has(Number(r))}function d(e){return Number(e.digest.split(";")[1])}function u(e){switch(e){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},40184,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RedirectStatusCode",{enumerable:!0,get:function(){return s}});var a,s=((a={})[a.SeeOther=303]="SeeOther",a[a.TemporaryRedirect=307]="TemporaryRedirect",a[a.PermanentRedirect=308]="PermanentRedirect",a);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},1939,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,s={REDIRECT_ERROR_CODE:function(){return i},RedirectType:function(){return o},isRedirectError:function(){return d}};for(var l in s)Object.defineProperty(r,l,{enumerable:!0,get:s[l]});let n=e.r(40184),i="NEXT_REDIRECT";var o=((a={}).push="push",a.replace="replace",a);function d(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let t=e.digest.split(";"),[r,a]=t,s=t.slice(2,-2).join(";"),l=Number(t.at(-2));return r===i&&("replace"===a||"push"===a)&&"string"==typeof s&&!isNaN(l)&&l in n.RedirectStatusCode}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},68934,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isNextRouterError",{enumerable:!0,get:function(){return l}});let a=e.r(91622),s=e.r(1939);function l(e){return(0,s.isRedirectError)(e)||(0,a.isHTTPAccessFallbackError)(e)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},9043,e=>{"use strict";var t=e.i(91398),r=e.i(91788),a=e.i(41158),s=e.i(58678),l=e.i(3998),n=e.i(97289),i=e.i(69547);let o=(0,i.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),d=(0,i.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),u=(0,i.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),c=(e,t="info")=>{window.showToast?.(e,t)};function f(){let[e,i]=(0,r.useState)(!1),[f,x]=(0,r.useState)([]),[m,b]=(0,r.useState)([]),[g,j]=(0,r.useState)([]),[y,v]=(0,r.useState)(""),[w,N]=(0,r.useState)(""),[_,P]=(0,r.useState)(""),[R,C]=(0,r.useState)(0),[O,S]=(0,r.useState)(""),[T,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l.auth.getUser()&&l.auth.isParent()?(i(!0),k()):M()},[]);let M=async()=>{try{let e=await n.api.getUsers();x(e.filter(e=>"TRUE"===String(e.active).toUpperCase()))}catch{c("Failed to load profiles","error")}},k=async()=>{try{E(!0);let[e,t]=await Promise.all([n.api.getKids(),n.api.getRewards()]);b(e||[]),j(t||[])}catch{c("Failed to sync dashboard","error")}finally{E(!1)}},A=async e=>{if(e.preventDefault(),!y||!w)return c("Missing credentials","warning");try{if(E(!0),!(await l.auth.loginAsParent(y,w)).success)throw Error();i(!0),c("Welcome back!","success"),await k()}catch{c("Invalid PIN","error")}finally{E(!1)}},L=async e=>{if(e.preventDefault(),!_||R<=0||!O)return c("Complete all fields","warning");try{E(!0),await n.api.awardPoints(_,R,O,l.auth.getUser()?.id),c(`â­ ${R} stars awarded`,"success"),C(0),S(""),P(""),k()}catch{c("Failed to award points","error")}finally{E(!1)}},U=(0,r.useMemo)(()=>m.reduce((e,t)=>e+t.balance,0),[m]),D=(0,r.useMemo)(()=>m.length?m.reduce((e,t)=>t.balance>e.balance?t:e):null,[m]);return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{children:(0,t.jsx)("title",{children:"Parent Dashboard"})}),(0,t.jsxs)("main",{className:"min-h-screen bg-neutral-50",children:[(0,t.jsx)("header",{className:"sticky top-0 z-40 bg-white border-b",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between px-6 py-4",children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Parent Dashboard"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:k,className:"rounded-lg px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200",children:(0,t.jsx)(d,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>{l.auth.logout(),location.href="/"},className:"rounded-lg px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:(0,t.jsx)(o,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto grid lg:grid-cols-3 gap-8 px-6 py-8",children:[(0,t.jsxs)("section",{className:"lg:col-span-2 space-y-8",children:[(0,t.jsx)("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 p-8 text-white",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[(0,t.jsx)(h,{label:"Kids",value:m.length}),(0,t.jsx)(h,{label:"Total Stars",value:U}),(0,t.jsx)(h,{label:"Rewards",value:g.length}),(0,t.jsx)(h,{label:"Top Kid",value:D?.name||"â€”"})]})}),(0,t.jsx)(p,{title:"Your Kids",children:(0,t.jsx)("div",{className:"grid sm:grid-cols-2 gap-4",children:m.map(e=>(0,t.jsxs)("div",{className:"rounded-xl border p-4 flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,t.jsx)("span",{className:"text-3xl",children:e.emoji}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[e.balance," â­"]})]})]}),(0,t.jsx)("button",{onClick:()=>P(e.kid_id),className:"text-sm text-blue-600 hover:underline",children:"Award"})]},e.kid_id))})}),(0,t.jsx)(p,{title:"Rewards",children:(0,t.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,t.jsxs)("div",{className:"flex justify-between border rounded-lg p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]}),(0,t.jsxs)("span",{className:"font-bold",children:[e.points_cost," â­"]})]},e.reward_id))})})]}),(0,t.jsx)("aside",{className:"space-y-6",children:(0,t.jsx)(p,{title:"Award Stars",children:(0,t.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,t.jsxs)("select",{value:_,onChange:e=>P(e.target.value),className:"w-full rounded-lg border px-3 py-2",children:[(0,t.jsx)("option",{value:"",children:"Select kid"}),m.map(e=>(0,t.jsx)("option",{value:e.kid_id,children:e.name},e.kid_id))]}),(0,t.jsx)("input",{type:"number",min:1,value:R,onChange:e=>C(+e.target.value||0),placeholder:"Stars",className:"w-full rounded-lg border px-3 py-2"}),(0,t.jsx)("textarea",{value:O,onChange:e=>S(e.target.value),placeholder:"Reason",rows:3,className:"w-full rounded-lg border px-3 py-2"}),(0,t.jsx)("button",{disabled:T,className:"w-full rounded-lg bg-emerald-600 py-2 text-white font-semibold hover:bg-emerald-700",children:"Award Stars"})]})})})]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{children:(0,t.jsx)("title",{children:"Parent Login"})}),(0,t.jsx)("main",{className:"min-h-screen grid place-items-center bg-gradient-to-b from-neutral-50 to-white px-4",children:(0,t.jsxs)("form",{onSubmit:A,className:"w-full max-w-md rounded-3xl bg-white shadow-2xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"relative bg-gradient-to-r from-blue-600 to-indigo-700 p-8 text-center text-white",children:[(0,t.jsx)(u,{className:"absolute right-6 top-6 opacity-30"}),(0,t.jsx)("div",{className:"text-5xl mb-3",children:"ðŸ”"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Parent Portal"}),(0,t.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Secure family access"})]}),(0,t.jsxs)("div",{className:"p-8 space-y-6",children:[(0,t.jsxs)("select",{className:"w-full rounded-xl border px-4 py-3 text-sm focus:ring-2 focus:ring-blue-200",value:y,onChange:e=>v(e.target.value),required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select profile"}),f.map(e=>(0,t.jsxs)("option",{value:e.user_id,children:[e.name," (",e.role,")"]},e.user_id))]}),(0,t.jsx)("input",{type:"password",placeholder:"PIN",maxLength:6,inputMode:"numeric",value:w,onChange:e=>N(e.target.value),className:"w-full rounded-xl border px-4 py-3 text-center tracking-widest font-mono text-lg",required:!0}),(0,t.jsx)("button",{disabled:T,className:"w-full rounded-xl bg-blue-600 py-3 font-semibold text-white hover:bg-blue-700 transition disabled:opacity-50",children:T?"Authenticatingâ€¦":"Unlock Dashboard"}),(0,t.jsx)(a.default,{href:"/",className:"block text-center text-sm text-gray-500 hover:text-blue-600",children:"â† Back to home"})]})]})})]})}function p({title:e,children:r}){return(0,t.jsxs)("div",{className:"rounded-2xl bg-white p-6 shadow-sm",children:[(0,t.jsx)("h2",{className:"mb-4 font-bold",children:e}),r]})}function h({label:e,value:r}){return(0,t.jsxs)("div",{className:"rounded-xl bg-white/10 p-4",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:r}),(0,t.jsx)("p",{className:"text-sm text-blue-100",children:e})]})}e.s(["default",()=>f],9043)},86636,(e,t,r)=>{let a="/parent";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(9043)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/28e14a26e92e0e1d.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);