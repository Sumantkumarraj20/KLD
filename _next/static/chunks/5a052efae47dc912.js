(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7045,e=>{"use strict";var t=e.i(7289);class l{static DEFAULT_EASE_FACTOR=2.5;static MIN_INTERVAL=1;static calculateNextInterval(e,t=0,l=this.DEFAULT_EASE_FACTOR){let a,s=Math.max(0,Math.min(5,Math.round(e)));if(s<3)return{interval:this.MIN_INTERVAL,easeFactor:this.DEFAULT_EASE_FACTOR};let i=Math.max(1.3,l+.1-(5-s)*(.08+(5-s)*.02));return a=0===t?1:1===t?3:Math.ceil(t*i),{interval:Math.max(this.MIN_INTERVAL,a),easeFactor:i}}static createCompletion(e,t,l){let a=new Date,s=new Date(a.getTime()+864e5),i=Math.max(0,Math.min(5,l));return{domain:e,levelNumber:t,completedAt:a.toISOString(),starsEarned:l,quality:i,repetitions:1,interval:1,easeFactor:this.DEFAULT_EASE_FACTOR,nextReviewAt:s.toISOString()}}static reviewCompletion(e,t){let{interval:l,easeFactor:a}=this.calculateNextInterval(t,e.interval,e.easeFactor),s=new Date;return s.setDate(s.getDate()+l),{...e,starsEarned:Math.max(e.starsEarned,Math.round(t)),repetitions:e.repetitions+1,interval:l,easeFactor:a,nextReviewAt:s.toISOString()}}static getLockStatus(e){if(!e||!e.nextReviewAt)return{isLocked:!1};let t=new Date(e.nextReviewAt),l=new Date;if(l>=t)return{isLocked:!1};let a=t.getTime()-l.getTime(),s=Math.floor(a/864e5),i=Math.floor(a%864e5/36e5),r=Math.floor(a%36e5/6e4);return{isLocked:!0,nextUnlockAt:t.toISOString(),daysUntilUnlock:s,hoursUntilUnlock:i,minutesUntilUnlock:r}}static formatTimeUntilUnlock(e){return e.isLocked?e.daysUntilUnlock||e.hoursUntilUnlock?e.daysUntilUnlock?`${e.daysUntilUnlock}d ${e.hoursUntilUnlock}h`:`${e.hoursUntilUnlock}h ${e.minutesUntilUnlock}m`:`${e.minutesUntilUnlock} min`:""}static resetLevel(e){return{...e,nextReviewAt:new Date().toISOString()}}}let a=new class{async submitLevelCompletion(e,a,s,i,r){try{let o=this.getDomainDisplayName(a),n=`${o} Level ${s} (${i}â˜…)`,c=`${a}-level-${s}`,m=l.createCompletion(a,s,i);this.storeLevelCompletion(e,c,m);let d=!1;for(let l=0;l<3;l++)try{await t.api.awardPoints(e,r,n,"game-engine"),d=!0,console.log(`âœ… Level completion (${n}) synced to backend on attempt ${l+1}`);break}catch(e){console.warn(`API sync attempt ${l+1}/3 failed for level completion:`,e),l<2&&await new Promise(e=>setTimeout(e,500*(l+1)))}d||console.warn(`Failed to sync level completion after 3 attempts - ${r} points will sync when connection restored`);let g={award_id:`award-${e}-${a}-level-${s}-${Date.now()}`,kid_id:e,level_id:`${a}-level-${s}`,domain:a,level_number:s,stars_earned:i,points_awarded:r,completed_at:new Date().toISOString(),reason:n};return this.cacheGameProgress(e,g),g}catch(e){throw console.error("Failed to submit level completion:",e),e}}async getKidGameProgress(e){try{let t=this.getLocalGameProgress(e);return{language_level:t.language||1,mathematics_level:t.mathematics||1,logical_level:t.logical||1,total_stars:t.total_stars||0}}catch(e){return console.error("Failed to get kid game progress:",e),{language_level:1,mathematics_level:1,logical_level:1,total_stars:0}}}getLocalGameProgress(e){let t=`game-progress-${e}`,l=localStorage.getItem(t);if(l)try{return JSON.parse(l)}catch{}return this.initializeGameProgress()}initializeGameProgress(){return{language:1,mathematics:1,logical:1,total_stars:0,last_session:null,completed_levels:{}}}cacheGameProgress(e,t){let l=`game-progress-${e}`,a=this.getLocalGameProgress(e),s=t.domain;t.level_number>(a[s]||0)&&(a[t.domain]=t.level_number),a.total_stars=(a.total_stars||0)+t.stars_earned,a.completed_levels[t.level_id]=Math.max(a.completed_levels[t.level_id]||0,t.stars_earned),a.last_session=t.completed_at,localStorage.setItem(l,JSON.stringify(a))}getKidSessions(e){let t=`game-sessions-${e}`,l=localStorage.getItem(t);if(l)try{return JSON.parse(l)}catch{}return[]}storeSession(e,t){let l=`game-sessions-${e}`,a=this.getKidSessions(e);a.push(t),a.length>100&&a.shift(),localStorage.setItem(l,JSON.stringify(a))}getLevelStars(e,t){return this.getLocalGameProgress(e).completed_levels[t]||0}isLevelUnlocked(e,t,l){if(1===l)return!0;let a=this.getLocalGameProgress(e),s=`${t}-level-${l-1}`;return(a.completed_levels[s]||0)>=3}getMaxUnlockedLevel(e,t){let l=this.getLocalGameProgress(e),a=1;for(let e=1;e<=50;e++){let s=`${t}-level-${e}`;if((l.completed_levels[s]||0)>=3)a=e;else if(1===e)break}return a}getDomainStars(e,t){return this.getKidSessions(e).filter(e=>e.domain===t).reduce((e,t)=>e+t.stars_earned,0)}exportGameProgress(e){let t=this.getLocalGameProgress(e),l=this.getKidSessions(e);return{kid_id:e,export_date:new Date().toISOString(),progress:t,sessions_count:l.length,domain_stats:{language:this.getDomainStars(e,"language"),mathematics:this.getDomainStars(e,"mathematics"),logical:this.getDomainStars(e,"logical")}}}clearGameProgress(e){localStorage.removeItem(`game-progress-${e}`),localStorage.removeItem(`game-sessions-${e}`),localStorage.removeItem(`level-completions-${e}`)}getDomainDisplayName(e){return({language:"Language",mathematics:"Mathematics",logical:"Logical"})[e]||e}storeLevelCompletion(e,t,l){let a=`level-completions-${e}`,s=localStorage.getItem(a),i=s?JSON.parse(s):{};i[t]=l,localStorage.setItem(a,JSON.stringify(i))}getLevelCompletion(e,t,l){let a=`level-completions-${e}`,s=localStorage.getItem(a);return s?JSON.parse(s)[`${t}-level-${l}`]||null:null}getLevelLockStatus(e,t,a){let s=this.getLevelCompletion(e,t,a);return l.getLockStatus(s??void 0)}canPlayLevel(e,t,l){return!this.getLevelLockStatus(e,t,l).isLocked}getTimeUntilUnlock(e,t,a){let s=this.getLevelLockStatus(e,t,a);return l.formatTimeUntilUnlock(s)}resetLevelLock(e,t,a){let s=this.getLevelCompletion(e,t,a);if(s){let i=l.resetLevel(s),r=`${t}-level-${a}`;this.storeLevelCompletion(e,r,i)}}};e.s(["gameAPI",0,a],7045)},6408,e=>{"use strict";let t=(0,e.i(9547).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],6408)},5707,e=>{"use strict";let t=(0,e.i(9547).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],5707)},6043,e=>{"use strict";let t=(0,e.i(9547).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],6043)},1714,e=>{"use strict";var t=e.i(1398),l=e.i(1788),a=e.i(4495),s=e.i(1158),i=e.i(3998),r=e.i(7045),o=e.i(6408),n=e.i(5707),c=e.i(6043);function m(){let[e,r]=(0,l.useState)(null),[n,c]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{let e=i.auth.getUser();e?.role==="kid"&&r({kid_id:e.id,name:e.name}),c(!1)},[]),n||!e)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-lg text-neutral-600",children:"Loading..."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.default,{children:[(0,t.jsx)("title",{children:"Mathematics - Kids Points"}),(0,t.jsx)("meta",{name:"description",content:"Practice Mathematics Skills"})]}),(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)(s.default,{href:"/game",className:"inline-flex items-center gap-2 text-purple-600 hover:text-purple-800 mb-4",children:[(0,t.jsx)(o.ArrowLeft,{size:20}),"Back to Domains"]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-purple-600 mb-2",children:"ðŸ”¢ Mathematics"}),(0,t.jsx)("p",{className:"text-neutral-600",children:"Master addition, subtraction, multiplication, and division"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:50},(e,t)=>t+1).map(l=>(0,t.jsx)(d,{kidId:e.kid_id,levelNumber:l},l))})]})})]})}function d({kidId:e,levelNumber:a}){let[s,i]=(0,l.useState)(!1),[o,m]=(0,l.useState)(""),[d,g]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let t=r.gameAPI.getTimeUntilUnlock(e,"mathematics",a),l=r.gameAPI.getLevelLockStatus(e,"mathematics",a),s=r.gameAPI.getLevelCompletion(e,"mathematics",a);i(l.isLocked),m(t),g(s?.starsEarned||0)},[e,a]),(0,t.jsxs)("div",{className:`relative rounded-lg shadow-md p-4 transition-all ${s?"bg-neutral-100 opacity-60 cursor-not-allowed":"bg-white hover:shadow-lg cursor-pointer"}`,onClick:s?void 0:()=>{window.location.href=`/game?domain=mathematics&level=${a}`},children:[d>0&&(0,t.jsx)("div",{className:"absolute top-2 right-2 flex gap-1",children:Array.from({length:d},(e,l)=>(0,t.jsx)("span",{className:"text-lg",children:"â­"},l))}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:["Level ",a]}),s?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-600",children:[(0,t.jsx)(c.Clock,{size:16}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Unlocks in ",o]})]}):(0,t.jsx)("div",{className:"text-sm text-neutral-600",children:"Ready to play"}),s&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-black/5",children:(0,t.jsx)(n.Lock,{size:32,className:"text-neutral-400"})})]})}e.s(["default",()=>m])},2840,(e,t,l)=>{let a="/domains/mathematics";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(1714)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},8761,e=>{e.v(t=>Promise.all(["static/chunks/66b8f93dfb02a11d.js"].map(t=>e.l(t))).then(()=>t(3594)))},8805,e=>{e.v(t=>Promise.all(["static/chunks/5ec9ab7aae3f3e76.js"].map(t=>e.l(t))).then(()=>t(9466)))}]);