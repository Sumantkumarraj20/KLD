(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1085,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={AppRouterContext:function(){return n},GlobalLayoutRouterContext:function(){return i},LayoutRouterContext:function(){return o},MissingSlotContext:function(){return u},TemplateContext:function(){return c}};for(var l in a)Object.defineProperty(r,l,{enumerable:!0,get:a[l]});let s=e.r(41705)._(e.r(91788)),n=s.default.createContext(null),o=s.default.createContext(null),i=s.default.createContext(null),c=s.default.createContext(null),u=s.default.createContext(new Set)},31430,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return l}});class a extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class l extends URLSearchParams{append(){throw new a}delete(){throw new a}set(){throw new a}sort(){throw new a}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},70008,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={NavigationPromisesContext:function(){return u},PathParamsContext:function(){return c},PathnameContext:function(){return i},ReadonlyURLSearchParams:function(){return n.ReadonlyURLSearchParams},SearchParamsContext:function(){return o},createDevToolsInstrumentedPromise:function(){return d}};for(var l in a)Object.defineProperty(r,l,{enumerable:!0,get:a[l]});let s=e.r(91788),n=e.r(31430),o=(0,s.createContext)(null),i=(0,s.createContext)(null),c=(0,s.createContext)(null),u=(0,s.createContext)(null);function d(e,t){let r=Promise.resolve(t);return r.status="fulfilled",r.value=t,r.displayName=`${e} (SSR)`,r}},14760,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={BailoutToCSRError:function(){return n},isBailoutToCSRError:function(){return o}};for(var l in a)Object.defineProperty(r,l,{enumerable:!0,get:a[l]});let s="BAILOUT_TO_CLIENT_SIDE_RENDERING";class n extends Error{constructor(e){super(`Bail out to client-side rendering: ${e}`),this.reason=e,this.digest=s}}function o(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===s}},91622,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={HTTPAccessErrorStatus:function(){return s},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return o},getAccessFallbackErrorTypeByStatus:function(){return u},getAccessFallbackHTTPStatus:function(){return c},isHTTPAccessFallbackError:function(){return i}};for(var l in a)Object.defineProperty(r,l,{enumerable:!0,get:a[l]});let s={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},n=new Set(Object.values(s)),o="NEXT_HTTP_ERROR_FALLBACK";function i(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r]=e.digest.split(";");return t===o&&n.has(Number(r))}function c(e){return Number(e.digest.split(";")[1])}function u(e){switch(e){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},40184,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RedirectStatusCode",{enumerable:!0,get:function(){return l}});var a,l=((a={})[a.SeeOther=303]="SeeOther",a[a.TemporaryRedirect=307]="TemporaryRedirect",a[a.PermanentRedirect=308]="PermanentRedirect",a);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},1939,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,l={REDIRECT_ERROR_CODE:function(){return o},RedirectType:function(){return i},isRedirectError:function(){return c}};for(var s in l)Object.defineProperty(r,s,{enumerable:!0,get:l[s]});let n=e.r(40184),o="NEXT_REDIRECT";var i=((a={}).push="push",a.replace="replace",a);function c(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let t=e.digest.split(";"),[r,a]=t,l=t.slice(2,-2).join(";"),s=Number(t.at(-2));return r===o&&("replace"===a||"push"===a)&&"string"==typeof l&&!isNaN(s)&&s in n.RedirectStatusCode}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},68934,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isNextRouterError",{enumerable:!0,get:function(){return s}});let a=e.r(91622),l=e.r(1939);function s(e){return(0,l.isRedirectError)(e)||(0,a.isHTTPAccessFallbackError)(e)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},37045,e=>{"use strict";var t=e.i(97289);class r{static DEFAULT_EASE_FACTOR=2.5;static MIN_INTERVAL=1;static calculateNextInterval(e,t=0,r=this.DEFAULT_EASE_FACTOR){let a,l=Math.max(0,Math.min(5,Math.round(e)));if(l<3)return{interval:this.MIN_INTERVAL,easeFactor:this.DEFAULT_EASE_FACTOR};let s=Math.max(1.3,r+.1-(5-l)*(.08+(5-l)*.02));return a=0===t?1:1===t?3:Math.ceil(t*s),{interval:Math.max(this.MIN_INTERVAL,a),easeFactor:s}}static createCompletion(e,t,r){let a=new Date,l=new Date(a.getTime()+864e5),s=Math.max(0,Math.min(5,r));return{domain:e,levelNumber:t,completedAt:a.toISOString(),starsEarned:r,quality:s,repetitions:1,interval:1,easeFactor:this.DEFAULT_EASE_FACTOR,nextReviewAt:l.toISOString()}}static reviewCompletion(e,t){let{interval:r,easeFactor:a}=this.calculateNextInterval(t,e.interval,e.easeFactor),l=new Date;return l.setDate(l.getDate()+r),{...e,starsEarned:Math.max(e.starsEarned,Math.round(t)),repetitions:e.repetitions+1,interval:r,easeFactor:a,nextReviewAt:l.toISOString()}}static getLockStatus(e){if(!e||!e.nextReviewAt)return{isLocked:!1};let t=new Date(e.nextReviewAt),r=new Date;if(r>=t)return{isLocked:!1};let a=t.getTime()-r.getTime(),l=Math.floor(a/864e5),s=Math.floor(a%864e5/36e5),n=Math.floor(a%36e5/6e4);return{isLocked:!0,nextUnlockAt:t.toISOString(),daysUntilUnlock:l,hoursUntilUnlock:s,minutesUntilUnlock:n}}static formatTimeUntilUnlock(e){return e.isLocked?e.daysUntilUnlock||e.hoursUntilUnlock?e.daysUntilUnlock?`${e.daysUntilUnlock}d ${e.hoursUntilUnlock}h`:`${e.hoursUntilUnlock}h ${e.minutesUntilUnlock}m`:`${e.minutesUntilUnlock} min`:""}static resetLevel(e){return{...e,nextReviewAt:new Date().toISOString()}}}let a=new class{async submitLevelCompletion(e,a,l,s,n){try{let o=this.getDomainDisplayName(a),i=`${o} Level ${l} (${s}â˜…)`,c=`${a}-level-${l}`,u=r.createCompletion(a,l,s);this.storeLevelCompletion(e,c,u);let d=!1;for(let r=0;r<3;r++)try{await t.api.awardPoints(e,n,i,"game-engine"),d=!0,console.log(`âœ… Level completion (${i}) synced to backend on attempt ${r+1}`);break}catch(e){console.warn(`API sync attempt ${r+1}/3 failed for level completion:`,e),r<2&&await new Promise(e=>setTimeout(e,500*(r+1)))}d||console.warn(`Failed to sync level completion after 3 attempts - ${n} points will sync when connection restored`);let m={award_id:`award-${e}-${a}-level-${l}-${Date.now()}`,kid_id:e,level_id:`${a}-level-${l}`,domain:a,level_number:l,stars_earned:s,points_awarded:n,completed_at:new Date().toISOString(),reason:i};return this.cacheGameProgress(e,m),m}catch(e){throw console.error("Failed to submit level completion:",e),e}}async getKidGameProgress(e){try{let t=this.getLocalGameProgress(e);return{language_level:t.language||1,mathematics_level:t.mathematics||1,logical_level:t.logical||1,total_stars:t.total_stars||0}}catch(e){return console.error("Failed to get kid game progress:",e),{language_level:1,mathematics_level:1,logical_level:1,total_stars:0}}}getLocalGameProgress(e){let t=`game-progress-${e}`,r=localStorage.getItem(t);if(r)try{return JSON.parse(r)}catch{}return this.initializeGameProgress()}initializeGameProgress(){return{language:1,mathematics:1,logical:1,total_stars:0,last_session:null,completed_levels:{}}}cacheGameProgress(e,t){let r=`game-progress-${e}`,a=this.getLocalGameProgress(e),l=t.domain;t.level_number>(a[l]||0)&&(a[t.domain]=t.level_number),a.total_stars=(a.total_stars||0)+t.stars_earned,a.completed_levels[t.level_id]=Math.max(a.completed_levels[t.level_id]||0,t.stars_earned),a.last_session=t.completed_at,localStorage.setItem(r,JSON.stringify(a))}getKidSessions(e){let t=`game-sessions-${e}`,r=localStorage.getItem(t);if(r)try{return JSON.parse(r)}catch{}return[]}storeSession(e,t){let r=`game-sessions-${e}`,a=this.getKidSessions(e);a.push(t),a.length>100&&a.shift(),localStorage.setItem(r,JSON.stringify(a))}getLevelStars(e,t){return this.getLocalGameProgress(e).completed_levels[t]||0}isLevelUnlocked(e,t,r){if(1===r)return!0;let a=this.getLocalGameProgress(e),l=`${t}-level-${r-1}`;return(a.completed_levels[l]||0)>=3}getMaxUnlockedLevel(e,t){let r=this.getLocalGameProgress(e),a=1;for(let e=1;e<=50;e++){let l=`${t}-level-${e}`;if((r.completed_levels[l]||0)>=3)a=e;else if(1===e)break}return a}getDomainStars(e,t){return this.getKidSessions(e).filter(e=>e.domain===t).reduce((e,t)=>e+t.stars_earned,0)}exportGameProgress(e){let t=this.getLocalGameProgress(e),r=this.getKidSessions(e);return{kid_id:e,export_date:new Date().toISOString(),progress:t,sessions_count:r.length,domain_stats:{language:this.getDomainStars(e,"language"),mathematics:this.getDomainStars(e,"mathematics"),logical:this.getDomainStars(e,"logical")}}}clearGameProgress(e){localStorage.removeItem(`game-progress-${e}`),localStorage.removeItem(`game-sessions-${e}`),localStorage.removeItem(`level-completions-${e}`)}getDomainDisplayName(e){return({language:"Language",mathematics:"Mathematics",logical:"Logical"})[e]||e}storeLevelCompletion(e,t,r){let a=`level-completions-${e}`,l=localStorage.getItem(a),s=l?JSON.parse(l):{};s[t]=r,localStorage.setItem(a,JSON.stringify(s))}getLevelCompletion(e,t,r){let a=`level-completions-${e}`,l=localStorage.getItem(a);return l?JSON.parse(l)[`${t}-level-${r}`]||null:null}getLevelLockStatus(e,t,a){let l=this.getLevelCompletion(e,t,a);return r.getLockStatus(l??void 0)}canPlayLevel(e,t,r){return!this.getLevelLockStatus(e,t,r).isLocked}getTimeUntilUnlock(e,t,a){let l=this.getLevelLockStatus(e,t,a);return r.formatTimeUntilUnlock(l)}resetLevelLock(e,t,a){let l=this.getLevelCompletion(e,t,a);if(l){let s=r.resetLevel(l),n=`${t}-level-${a}`;this.storeLevelCompletion(e,n,s)}}};e.s(["gameAPI",0,a],37045)},86408,e=>{"use strict";let t=(0,e.i(69547).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],86408)},35707,e=>{"use strict";let t=(0,e.i(69547).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],35707)},56043,e=>{"use strict";let t=(0,e.i(69547).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],56043)},31714,e=>{"use strict";var t=e.i(91398),r=e.i(91788),a=e.i(58678),l=e.i(41158),s=e.i(3998),n=e.i(37045),o=e.i(86408),i=e.i(35707),c=e.i(56043),u=e.i(17837);function d(){let[e,n]=(0,r.useState)(null),[i,c]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=s.auth.getUser();e?.role==="kid"&&n({kid_id:e.id,name:e.name}),c(!1)},[]),i||!e)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-lg text-neutral-600",children:"Loading..."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.default,{children:[(0,t.jsx)("title",{children:"Mathematics - Kids Points"}),(0,t.jsx)("meta",{name:"description",content:"Practice Mathematics Skills"})]}),(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)(l.default,{href:"/game",className:"inline-flex items-center gap-2 text-purple-600 hover:text-purple-800 mb-4",children:[(0,t.jsx)(o.ArrowLeft,{size:20}),"Back to Domains"]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-purple-600 mb-2",children:"ðŸ”¢ Mathematics"}),(0,t.jsx)("p",{className:"text-neutral-600",children:"Master addition, subtraction, multiplication, and division"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:50},(e,t)=>t+1).map(r=>(0,t.jsx)(m,{kidId:e.kid_id,levelNumber:r},r))})]})})]})}function m({kidId:e,levelNumber:a}){let[l,s]=(0,r.useState)(!1),[o,d]=(0,r.useState)(""),[m,g]=(0,r.useState)(0),f=(0,u.useRouter)();return(0,r.useEffect)(()=>{let t=n.gameAPI.getTimeUntilUnlock(e,"mathematics",a),r=n.gameAPI.getLevelLockStatus(e,"mathematics",a),l=n.gameAPI.getLevelCompletion(e,"mathematics",a);s(r.isLocked),d(t),g(l?.starsEarned||0)},[e,a]),(0,t.jsxs)("div",{className:`relative rounded-lg shadow-md p-4 transition-all ${l?"bg-neutral-100 opacity-60 cursor-not-allowed":"bg-white hover:shadow-lg cursor-pointer"}`,onClick:l?void 0:()=>{f.push(`/game?domain=mathematics&level=${a}`)},children:[m>0&&(0,t.jsx)("div",{className:"absolute top-2 right-2 flex gap-1",children:Array.from({length:m},(e,r)=>(0,t.jsx)("span",{className:"text-lg",children:"â­"},r))}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:["Level ",a]}),l?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-600",children:[(0,t.jsx)(c.Clock,{size:16}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Unlocks in ",o]})]}):(0,t.jsx)("div",{className:"text-sm text-neutral-600",children:"Ready to play"}),l&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-black/5",children:(0,t.jsx)(i.Lock,{size:32,className:"text-neutral-400"})})]})}e.s(["default",()=>d])},62840,(e,t,r)=>{let a="/domains/mathematics";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(31714)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/28e14a26e92e0e1d.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);