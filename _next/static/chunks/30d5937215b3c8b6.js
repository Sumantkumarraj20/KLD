(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9043,e=>{"use strict";var a=e.i(1398),s=e.i(1788),t=e.i(1158),l=e.i(4495),r=e.i(3998),i=e.i(7289),d=e.i(9547);let n=(0,d.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),c=(0,d.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),o=(0,d.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),h=(e,a="info")=>{window.showToast?.(e,a)};function u(){let[e,d]=(0,s.useState)(!1),[u,p]=(0,s.useState)([]),[g,b]=(0,s.useState)([]),[j,f]=(0,s.useState)([]),[w,v]=(0,s.useState)(""),[N,y]=(0,s.useState)(""),[k,S]=(0,s.useState)(""),[P,_]=(0,s.useState)(0),[C,M]=(0,s.useState)(""),[T,U]=(0,s.useState)(!1);(0,s.useEffect)(()=>{r.auth.getUser()&&r.auth.isParent()?(d(!0),R()):A()},[]);let A=async()=>{try{let e=await i.api.getUsers();p(e.filter(e=>"TRUE"===String(e.active).toUpperCase()))}catch{h("Failed to load profiles","error")}},R=async()=>{try{U(!0);let[e,a]=await Promise.all([i.api.getKids(),i.api.getRewards()]);b(e||[]),f(a||[])}catch{h("Failed to sync dashboard","error")}finally{U(!1)}},E=async e=>{if(e.preventDefault(),!w||!N)return h("Missing credentials","warning");try{if(U(!0),!(await r.auth.loginAsParent(w,N)).success)throw Error();d(!0),h("Welcome back!","success"),await R()}catch{h("Invalid PIN","error")}finally{U(!1)}},K=async e=>{if(e.preventDefault(),!k||P<=0||!C)return h("Complete all fields","warning");try{U(!0),await i.api.awardPoints(k,P,C,r.auth.getUser()?.id),h(`â­ ${P} stars awarded`,"success"),_(0),M(""),S(""),R()}catch{h("Failed to award points","error")}finally{U(!1)}},D=(0,s.useMemo)(()=>g.reduce((e,a)=>e+a.balance,0),[g]),F=(0,s.useMemo)(()=>g.length?g.reduce((e,a)=>a.balance>e.balance?a:e):null,[g]);return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.default,{children:(0,a.jsx)("title",{children:"Parent Dashboard"})}),(0,a.jsxs)("main",{className:"min-h-screen bg-neutral-50",children:[(0,a.jsx)("header",{className:"sticky top-0 z-40 bg-white border-b",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between px-6 py-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Parent Dashboard"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:R,className:"rounded-lg px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200",children:(0,a.jsx)(c,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>{r.auth.logout(),location.href="/"},className:"rounded-lg px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:(0,a.jsx)(n,{className:"h-4 w-4"})})]})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto grid lg:grid-cols-3 gap-8 px-6 py-8",children:[(0,a.jsxs)("section",{className:"lg:col-span-2 space-y-8",children:[(0,a.jsx)("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 p-8 text-white",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[(0,a.jsx)(m,{label:"Kids",value:g.length}),(0,a.jsx)(m,{label:"Total Stars",value:D}),(0,a.jsx)(m,{label:"Rewards",value:j.length}),(0,a.jsx)(m,{label:"Top Kid",value:F?.name||"â€”"})]})}),(0,a.jsx)(x,{title:"Your Kids",children:(0,a.jsx)("div",{className:"grid sm:grid-cols-2 gap-4",children:g.map(e=>(0,a.jsxs)("div",{className:"rounded-xl border p-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,a.jsx)("span",{className:"text-3xl",children:e.emoji}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.balance," â­"]})]})]}),(0,a.jsx)("button",{onClick:()=>S(e.kid_id),className:"text-sm text-blue-600 hover:underline",children:"Award"})]},e.kid_id))})}),(0,a.jsx)(x,{title:"Rewards",children:(0,a.jsx)("div",{className:"space-y-3",children:j.map(e=>(0,a.jsxs)("div",{className:"flex justify-between border rounded-lg p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]}),(0,a.jsxs)("span",{className:"font-bold",children:[e.points_cost," â­"]})]},e.reward_id))})})]}),(0,a.jsx)("aside",{className:"space-y-6",children:(0,a.jsx)(x,{title:"Award Stars",children:(0,a.jsxs)("form",{onSubmit:K,className:"space-y-4",children:[(0,a.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full rounded-lg border px-3 py-2",children:[(0,a.jsx)("option",{value:"",children:"Select kid"}),g.map(e=>(0,a.jsx)("option",{value:e.kid_id,children:e.name},e.kid_id))]}),(0,a.jsx)("input",{type:"number",min:1,value:P,onChange:e=>_(+e.target.value||0),placeholder:"Stars",className:"w-full rounded-lg border px-3 py-2"}),(0,a.jsx)("textarea",{value:C,onChange:e=>M(e.target.value),placeholder:"Reason",rows:3,className:"w-full rounded-lg border px-3 py-2"}),(0,a.jsx)("button",{disabled:T,className:"w-full rounded-lg bg-emerald-600 py-2 text-white font-semibold hover:bg-emerald-700",children:"Award Stars"})]})})})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.default,{children:(0,a.jsx)("title",{children:"Parent Login"})}),(0,a.jsx)("main",{className:"min-h-screen grid place-items-center bg-gradient-to-b from-neutral-50 to-white px-4",children:(0,a.jsxs)("form",{onSubmit:E,className:"w-full max-w-md rounded-3xl bg-white shadow-2xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative bg-gradient-to-r from-blue-600 to-indigo-700 p-8 text-center text-white",children:[(0,a.jsx)(o,{className:"absolute right-6 top-6 opacity-30"}),(0,a.jsx)("div",{className:"text-5xl mb-3",children:"ðŸ”"}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Parent Portal"}),(0,a.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Secure family access"})]}),(0,a.jsxs)("div",{className:"p-8 space-y-6",children:[(0,a.jsxs)("select",{className:"w-full rounded-xl border px-4 py-3 text-sm focus:ring-2 focus:ring-blue-200",value:w,onChange:e=>v(e.target.value),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select profile"}),u.map(e=>(0,a.jsxs)("option",{value:e.user_id,children:[e.name," (",e.role,")"]},e.user_id))]}),(0,a.jsx)("input",{type:"password",placeholder:"PIN",maxLength:6,inputMode:"numeric",value:N,onChange:e=>y(e.target.value),className:"w-full rounded-xl border px-4 py-3 text-center tracking-widest font-mono text-lg",required:!0}),(0,a.jsx)("button",{disabled:T,className:"w-full rounded-xl bg-blue-600 py-3 font-semibold text-white hover:bg-blue-700 transition disabled:opacity-50",children:T?"Authenticatingâ€¦":"Unlock Dashboard"}),(0,a.jsx)(t.default,{href:"/",className:"block text-center text-sm text-gray-500 hover:text-blue-600",children:"â† Back to home"})]})]})})]})}function x({title:e,children:s}){return(0,a.jsxs)("div",{className:"rounded-2xl bg-white p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"mb-4 font-bold",children:e}),s]})}function m({label:e,value:s}){return(0,a.jsxs)("div",{className:"rounded-xl bg-white/10 p-4",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:s}),(0,a.jsx)("p",{className:"text-sm text-blue-100",children:e})]})}e.s(["default",()=>u],9043)},6636,(e,a,s)=>{let t="/parent";(window.__NEXT_P=window.__NEXT_P||[]).push([t,()=>e.r(9043)]),a.hot&&a.hot.dispose(function(){window.__NEXT_P.push([t])})},8761,e=>{e.v(a=>Promise.all(["static/chunks/66b8f93dfb02a11d.js"].map(a=>e.l(a))).then(()=>a(3594)))},8805,e=>{e.v(a=>Promise.all(["static/chunks/5ec9ab7aae3f3e76.js"].map(a=>e.l(a))).then(()=>a(9466)))}]);